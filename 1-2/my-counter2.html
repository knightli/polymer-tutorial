<!--
 必须 import 此行, 否则会报如下错误:
You tried to use polymer without loading it first. To load polymer, <link rel="import" href="components/polymer/polymer.html"> 
-->
<link rel="import" href="../components/polymer/polymer.html">

<!-- 定义 polymer element -->
<polymer-element name="my-counter" attributes="counter">
  <template>
    <style>
    .highlight{
      background-color: yellow;
    }
    </style>
    <div id="label"><content></content></div>
    Value: <span id="counterVal">{{counter}}</span><br>
    <button on-tap="{{increment}}">Increment</button>
  </template>
  <script>
    var timer;
    Polymer({
      counter: 0, // Default value
      counterChanged: function() {
        if(timer) clearTimeout(timer);

        // error case
        

        
        // fix with bind
        timer = setTimeout((function(){
          this.$.counterVal.classList.remove('highlight');
        }).bind(this),1000);
        

        /*
        // fix with closure
        var _this = this;
        _this.$.counterVal.classList.add('highlight');
        timer = setTimeout(function(){
          _this.$.counterVal.classList.remove('highlight');
        },1000);
        */
      },
      increment: function() {
        this.counter++;
      }
    });
  </script>
</polymer-element>